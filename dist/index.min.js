!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("log4js"),require("fs"),require("app-root-path"),require("path"),require("chalk")):"function"==typeof define&&define.amd?define(["exports","log4js","fs","app-root-path","path","chalk"],r):r((e=e||self).Index={},e.log4js,e.fs,e["app-root-path"],e.path,e.chalk)}(this,(function(e,r,t,n,o,a){"use strict";function s(e,r,t,n,o,a,s){try{var u=e[a](s),i=u.value}catch(e){return void t(e)}u.done?r(i):Promise.resolve(i).then(n,o)}t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n,o=o&&o.hasOwnProperty("default")?o.default:o,a=a&&a.hasOwnProperty("default")?a.default:a;var u=o.resolve,i=(o.join,u(__dirname),u(n.path,"./logs")),p={appenders:{errorLogger:{type:"dateFile",filename:i+"/error/error",alwaysIncludePattern:!0,pattern:"-yyyy-MM-dd-hh.log",path:"/error"},resLogger:{type:"dateFile",filename:i+"/response/response",alwaysIncludePattern:!0,pattern:"-yyyy-MM-dd-hh.log",path:"/response"}},categories:{default:{appenders:["resLogger","errorLogger"],level:"info"},errorLogger:{appenders:["errorLogger"],level:"error"},resLogger:{appenders:["resLogger"],level:"info"}},baseLogPath:i};r.configure(p);var l={},g=function(e){t.existsSync(e)||(t.mkdirSync(e),console.log("createPath:"+e))};p.baseLogPath&&(g(p.baseLogPath),Object.values(p.appenders).forEach((function(e){e.path&&g(p.baseLogPath+e.path)})));var f=r.getLogger("errorLogger"),c=r.getLogger("resLogger");l.logError=function(e,r,t){e&&r&&f.error(h(e,r,t))},l.logResponse=function(e,r){e&&c.info(d(e,r))};var d=function(e,r){var t="";return t+="\n*************** response log start ***************\n",t+=y(e.request,r),t+="response status: "+e.status+"\n",t+="response body: \n"+JSON.stringify(e.body)+"\n",t+="*************** response log end ***************\n"},h=function(e,r,t){var n="";return n+="\n*************** error log start ***************\n",n+=y(e.request,t),n+="err name:"+r.name+"\n",n+="err message:"+r.message+"\n",n+="err stack:"+r.stack+"\n",n+="*************** error log end ***************\n"},y=function(e,r){var t="",n=e.method;return t+="request method: "+n+"\n",t+="request originalUrl: "+e.originalUrl+"\n",t+="request client ip: "+e.ip+"\n",t+="GET"===n?"request query: "+JSON.stringify(e.query)+"\n":"request body: \n"+JSON.stringify(e.body)+"\n",t+="response time:"+r+"\n"},v=function(){var e,r=(e=regeneratorRuntime.mark((function e(r,t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,e.prev=1,e.next=4,t();case 4:o=new Date-n,console.log(a.blue("%s")+" "+r.request.method+" "+r.request.url,Date.now()),l.logResponse(r,o),e.next=15;break;case 9:e.prev=9,e.t0=e.catch(1),r.response.body={message:e.t0.message},o=new Date-n,l.logError(r,e.t0,o),r.app.emit("error",e.t0,r);case 15:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function u(e){s(a,n,o,u,i,"next",e)}function i(e){s(a,n,o,u,i,"throw",e)}u(void 0)}))});return function(e,t){return r.apply(this,arguments)}}();e.koaLogger=v,Object.defineProperty(e,"__esModule",{value:!0})}));
